# VCT
Data and code associated with "Assessing the Role of Patient Generation Techniques in Virtual Clinical Trial Outcomes" (Gevertz and Wares, 2024, Bulletin of Mathematical Biology 86: 119) is found in the Compare_Methods and Create_Simulated_Patients folders.
- To generate simulated patient data, run main_CA_vary_interactions_JG.m in Create_Simulated_Patients folder. This step is not required to run the virtual clinical trials, as the simulated data we used is already saved in CA_tumors.mat in the Compare_Methods folder. 
- To generate data displayed in Figures 4-6, run VCT_figures456Final.m in Compare_Methods folder.
- The data in Figure 7 comes from changing parameter values in VCT_figures456Final.m and collecting the statistics across runs.

Data and code associated with "A practical guide for the generation of model-based virtual clinical trials" (Craig, Gevertz, Kareva, Wilkie, 2025, Frontiers in Systems Biology 3: 1174647) is found in the OV_VPops folder.
- Running any code in this folder requires saving the data_Ad.mat file in the same directory as the codes
- The virtual patients are generated by running OV_VPops.m. The output that is presented in Figure 3 of the cited paper is found in the uploaded VPops.mat file.
- OV_VCT.m reads in the data and the virtual patients to conduct the virtual clinical trial.

Data and code associated with "Assessing the Role of Model Complexity in Virtual Clinical Trial Outcomes" is found in the OV_VCT folder. Where to find the code to generate each figure in the manuscript is detailed here. 
- Fig. 3 (Model fitting): Run OV_fitting_[type]_model.m found in Simple_Model, Intermediate_Model, and Complex_Model subfolder.
- Fig. 4 (VPop trajectories): Run OV_Vpops_[type]_model.m found either Simple_Model, Intermediate_Model, and Complex_Model subfolder.
- Fig. 5-7 (VPop posteriors): Run OV_Vpops_[type]_model.m found either Simple_Model, Intermediate_Model, and Complex_Model subfolder. 
- Fig. 8 (VCT outcomes): Run OV_VCT.m found in Simple_Model, Intermediate_Model, and Complex_Model subfolder to generate .mat files to be read into compare_models.m. Pre-generated .mat files are already found in these subfolders, allowing compare_models.m to be run without running these other codes.
- Fig. 9 (Shannon entropy): Run shannon_entropy.m.
- Fig. 10-11 (VPop posteriors sorted by response): Run compre_subgropus_within_models.m.
- Fig. S1 (Control fits): Run fit_control.m in Control subfolder.
- Fig. S2 (Uniformity score): Run uniformity_score.m
- Fig. S3-S5 (VPop posteriors): Run OV_Vpops_[type]_model_flip_distribution.m found either Simple_Model, Intermediate_Model, and Complex_Model subfolder.
- Fig. S6 (Shannon entropy): Run shannon_entropy.m. 
